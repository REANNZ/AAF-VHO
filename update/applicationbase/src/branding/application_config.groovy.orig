appName=""
grails {
  serverURL = "http://localhost:8080/${appName}"
  mail.default.from="noreply@aaf.edu.au"
}

environments {
  // REMOVE IF PRODUCTION
  development {
    greenmail.disabled = false
    grails {
      resources.debug = true
      gsp.enable.reload = true
      logging.jul.usebridge = true
      mail {
        port = com.icegreen.greenmail.util.ServerSetupTest.SMTP.port
      }
    }

    dataSource {
      pooled = true
      driverClassName = "org.h2.Driver"
      username = "sa"
      password = ""
      dbCreate = "create-drop"
      url = "jdbc:h2:mem:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000"
    }
  }

  // REMOVE IF DEVELOPMENT
  production {
    greenmail.disabled = true
    testDataConfig.enabled = false
    grails {
      resources.debug = false  
      gsp.enable.reload = false
      logging.jul.usebridge = false
      mail {
        host = 'localhost' // More advanced mail config available per: http://grails.org/plugin/mail
      }
    }
    dataSource {
      dbCreate = "update"
      dialect= org.hibernate.dialect.MySQL5InnoDBDialect
      jndiName= "java:comp/env/jdbc/APPNAME" 
    }
  }
}

aaf {
  base {

    // Bootstrap - Allows unauthenticated access to administrative console
    bootstrap = false

    // Session Expiry Warning - minutes
    session_warning = 50 
    session_decision_time = 5

    // Deployed AAF environment [development | test | production]
    deployment_environment = "development"

    realms {
      federated { 
        active = true
        automate_login = false
        auto_provision = true
        sso_endpoint = "/Shibboleth.sso/Login"

        // Supported as fallback for problematic webservers
        // AAF webserver configuration shouldn't require this to be false.
        // See https://wiki.shibboleth.net/confluence/display/SHIB2/NativeSPAttributeAccess for more
        request.attributes = true

        require {
          sharedtoken = true
          cn = true
          email = true
        }
        
        
        mapping {
          principal = "persistent-id"   // The unique and persistent ID used to identify this principal for current and subsequent sessions (eduPersonTargetedID)
          credential = "Shib-Session-ID"  // The internal session key assigned to the session associated with the request and hence the credential used
          entityID = "Shib-Identity-Provider" // The entityID of the IdP that authenticated the subject associated with the request.
          
          applicationID = "Shib-Application-ID" // The applicationId property derived for the request.     
          idpAuthenticationInstant = "Shib-Authentication-Instant" // The ISO timestamp provided by the IdP indicating the time of authentication. 
          
          cn = "cn"
          email= "mail"
          sharedToken = "auEduPersonSharedToken"
        }

        development {
          active = false
        }
      }
    }
  }
}
